// prisma/workspace.prisma

model Workspace {
    id          String  @id @default(cuid())
    name        String
    description String?
    iconUrl     String? @map("icon_url")

    // AI Kota Yönetimi (Kullanıcıdan buraya taşıdık)
    aiCredits Int @default(1000) @map("ai_credits")
    aiUsage   Int @default(0) @map("ai_usage")

    createdAt DateTime @default(now()) @map("created_at")
    updatedAt DateTime @updatedAt @map("updated_at")

    // İlişkiler
    members   WorkspaceMember[]
    documents Document[] // content.prisma'dan gelecek

    @@map("workspaces")
}

model WorkspaceMember {
    id   String        @id @default(cuid())
    role WorkspaceRole @default(MEMBER)

    // Hangi kullanıcı?
    userId String @map("user_id")
    user   Users  @relation(fields: [userId], references: [id], onDelete: Cascade)

    // Hangi takım?
    workspaceId String    @map("workspace_id")
    workspace   Workspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

    joinedAt DateTime @default(now()) @map("joined_at")

    // Bir kullanıcı bir takıma sadece bir kez girebilir
    @@unique([userId, workspaceId])
    @@map("workspace_members")
}
